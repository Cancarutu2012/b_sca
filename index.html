<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vonalkód Olvasó</title>
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode/minified/html5-qrcode.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; max-width: 480px; margin: 30px auto; }
        #qr-reader { width: 100%; height: 300px; display: block; margin-bottom: 20px; }
        #nameDisplay { font-size: 40px; color: green; font-weight: bold; }
        #message { font-weight: bold; font-size: 18px; margin-top: 10px; }
        #nameTable { margin-top: 20px; width: 100%; border-collapse: collapse; }
        #nameTable th, td { border: 1px solid black; padding: 10px; text-align: center; }
        #sendButton { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #4CAF50; color: white; border: none; }
        #sendButton:disabled { background-color: #ccc; }
    </style>
</head>
<body>

<h2>Vonalkód Olvasó</h2>

<div id="qr-reader"></div>

<div id="nameDisplay" style="display:none;"></div>
<div id="message" style="display:none;">MEHETSZ</div>

<table id="nameTable" style="display:none;">
    <thead>
        <tr><th>Beolvasott Nevek</th></tr>
    </thead>
    <tbody id="nameList"></tbody>
</table>

<button id="sendButton" onclick="sendEmail()" style="display:none;">Küld</button>

<script>
    let scanner = new Html5QrcodeScanner("qr-reader", { fps: 10, qrbox: 250 });
    let nameList = [];
    let isScanning = false;

    // Beolvasott üzenet dekódolása
    function decodeMessage(decodedText) {
        const name = decodedText.trim();
        if (name) {
            // Nevet zöld színnel megjeleníteni
            const nameDisplay = document.getElementById("nameDisplay");
            nameDisplay.textContent = name;
            nameDisplay.style.display = "block";
            document.getElementById("message").style.display = "block";
            
            // Hozzáadjuk a táblázathoz
            const tableBody = document.getElementById("nameList");
            const newRow = document.createElement("tr");
            const newCell = document.createElement("td");
            newCell.textContent = name;
            newRow.appendChild(newCell);
            tableBody.appendChild(newRow);

            // Megjeleníti a táblázatot és a Küld gombot
            document.getElementById("nameTable").style.display = "block";
            document.getElementById("sendButton").style.display = "inline-block";
        }
    }

    // Email küldése
    function sendEmail() {
        const tableContent = [];
        const rows = document.getElementById("nameList").getElementsByTagName("tr");
        for (let row of rows) {
            tableContent.push(row.innerText);
        }

        const emailSubject = "Beolvasott Nevek";
        const emailBody = `A következő neveket olvastuk be:\n\n${tableContent.join("\n")}`;

        window.location.href = `mailto:radetzkymate@gmail.com?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
    }

    // QR kód olvasása
    function onScanSuccess(decodedText, decodedResult) {
        if (isScanning) {
            isScanning = false;
            scanner.clear();
            decodeMessage(decodedText);
        }
    }

    // QR kód olvasó beállítása
    function startScanner() {
        isScanning = true;
        scanner.render(onScanSuccess);
    }

    // QR olvasó indítása
    startScanner();
</script>

</body>
</html>
